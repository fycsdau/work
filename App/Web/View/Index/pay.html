<include file="Public/head" /><body>	<header class="page-header">		<i class="header-left icon-func user-icon-fanhui"></i>		<div class="header-title">支付</div>	</header>	<section class="container">		<section>			<div class="section-box-white section-padded">				<div class="section-box-item pay-amount-key">					<i class="user-icon-qianbi"></i> 需支付				</div>				<div class="section-box-item pay-amount">					<span id="order_money">{$order_money}</span> 元				</div>			</div>		</section>		<section>			<div class="section-title">请选择支付方式</div>			<ul class="mui-table-view pay-type-list">				<eq name="is_wechat" value="1">					<li class="mui-table-view-cell">						<a class="mui-navigate-right" id="chooseWXPay">							<i class="user-icon-weixin pay-type-weixin"></i> 微信支付						</a>					</li>				</eq>				<li class="mui-table-view-cell">					<a class="mui-navigate-right">						<div class="section-box" onclick="javascript:amount()">													<div class="section-box-item"><i class="user-icon-iconhqb01 pay-type-linqian"></i> 零钱支付</div>							<div class="section-box-item linqian-balance">余额：{$user_money|default="0.00"}元</div>							<input type="hidden" id="amount" value="{$user_money|default='0.00'}">												</div>					</a>				</li>			</ul>		</section>	</section>    <div style="width:100%; height:60px; display:block;"></div>	<script src="__PUBLIC__/web/js/zepto.min.js"></script>	<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>	<script src="__PUBLIC__/web/lib/js/mui.min.js"></script>	<script src="__PUBLIC__/web/js/common.js"></script>	<script type="text/javascript">		function amount(){		var order_money = document.getElementById('order_money').innerHTML;		//var amount = document.getElementById('amount').value;		var amount = 100;		alert(amount);		if(order_money > amount){			alert("很抱歉，您的余额不足！！");		}else{			var mes=confirm("您确定要使用余额支付吗？");			if(mes==true){ 				$.ajax({					type:"POST",			   		url:"{:U('Index/ajaxAmountPay')}",			   		data:{"order_money":order_money},			   		//成功返回之后调用的函数            			   		success:function(data){						window.location.href="/index.php/user/order_detail/id/{$last_id}";			  		},				});			}			else{ 							}					}	}	<eq name="is_wechat" value="1">	$("#chooseWXPay").click(function(){		callpay();	})	//调用微信JS api 支付	function jsApiCall(){		WeixinJSBridge.invoke(			'getBrandWCPayRequest',			{$jsApiParameters},			function(res){				WeixinJSBridge.log(res.err_msg);				if(res.err_msg == 'get_brand_wcpay_request:cancel') {					window.location.href="/index.php/user/order_detail/id/{$last_id}";					//alert("您已取消了此次支付");					return;				} else if(res.err_msg == 'get_brand_wcpay_request:fail') {					window.location.href="/index.php/user/order_detail/id/{$last_id}";					alert("支付失败");					return;				} else if(res.err_msg == 'get_brand_wcpay_request:ok') {					window.location.href="/index.php/user/orders";                    //alert("支付成功！");//跳转到订单页面                                    } else {                	alert("未知错误"+res.error_msg);                	return;                }            }            );	}	function callpay(){		if (typeof WeixinJSBridge == "undefined"){			if( document.addEventListener ){				document.addEventListener('WeixinJSBridgeReady', jsApiCall, false);			}else if (document.attachEvent){				document.attachEvent('WeixinJSBridgeReady', jsApiCall); 				document.attachEvent('onWeixinJSBridgeReady', jsApiCall);			}		}else{			jsApiCall();		}	}	</eq>	</script></body></html>